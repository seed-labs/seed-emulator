<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEEDé‚®ä»¶ç³»ç»Ÿç»¼åˆæ€»è§ˆ - 4257</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        .cyber-text {
            background: linear-gradient(45deg, #00ff88, #0088ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }

        .dark-bg {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .status-online {
            color: #00ff88;
            animation: pulse 2s infinite;
        }

        .status-offline {
            color: #ff4444;
        }

        .status-unknown {
            color: #ffaa00;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .project-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        .code-preview {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            overflow-x: auto;
            white-space: pre;
        }

        .tech-badge {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
        }

        .tab-content {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="dark-bg">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark glass-card mb-4">
        <div class="container-fluid">
            <a class="navbar-brand cyber-text" href="#">
                <i class="fas fa-server"></i> SEEDé‚®ä»¶ç³»ç»Ÿç»¼åˆæ€»è§ˆ
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab" aria-controls="overview" aria-selected="true">
                            <i class="fas fa-home"></i> æ€»è§ˆ
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" id="guide-tab" data-bs-toggle="tab" data-bs-target="#guide" type="button" role="tab" aria-controls="guide" aria-selected="false">
                            <i class="fas fa-book"></i> å®è·µæŒ‡å—
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" id="tech-tab" data-bs-toggle="tab" data-bs-target="#tech" type="button" role="tab" aria-controls="tech" aria-selected="false">
                            <i class="fas fa-cogs"></i> æŠ€æœ¯æ€»ç»“
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" id="code-tab" data-bs-toggle="tab" data-bs-target="#code" type="button" role="tab" aria-controls="code" aria-selected="false">
                            <i class="fas fa-code"></i> ä»£ç ç»“æ„
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" id="design-tab" data-bs-toggle="tab" data-bs-target="#design" type="button" role="tab" aria-controls="design" aria-selected="false">
                            <i class="fas fa-brain"></i> è®¾è®¡æ€è·¯
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" id="issues-tab" data-bs-toggle="tab" data-bs-target="#issues" type="button" role="tab" aria-controls="issues" aria-selected="false">
                            <i class="fas fa-exclamation-triangle"></i> é—®é¢˜&æµ‹è¯•
                        </button>
                    </li>
                </ul>
                <div class="d-flex">
                    <button class="btn btn-outline-info me-2" onclick="refreshStatus()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°çŠ¶æ€
                    </button>
                    <button class="btn btn-outline-danger" onclick="stopAllProjects()">
                        <i class="fas fa-stop"></i> åœæ­¢å…¨éƒ¨
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <div class="tab-content">
            <!-- æ€»è§ˆæ ‡ç­¾é¡µ -->
            <div class="tab-pane fade show active" id="overview">
                <div class="row">
                    <div class="col-12">
                        <div class="card glass-card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h4 class="mb-0">
                                    <i class="fas fa-chart-line"></i> ç³»ç»ŸçŠ¶æ€æ€»è§ˆ
                                    <span class="badge bg-success float-end" id="system-status">åœ¨çº¿</span>
                                </h4>
                            </div>
                            <div class="card-body">
                                <div class="row" id="status-overview">
                                    <!-- åŠ¨æ€åŠ è½½çŠ¶æ€ä¿¡æ¯ -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- é¡¹ç›®å¡ç‰‡ -->
                <div class="row">
                    {% for project_id, project in projects.items() %}
                    <div class="col-lg-3 col-md-6 mb-4">
                        <div class="card glass-card project-card h-100" onclick="showProjectDetails('{{ project_id }}')">
                            <div class="card-header bg-secondary text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-project-diagram"></i> {{ project.name }}
                                    <span class="badge bg-success float-end">{{ project.status }}</span>
                                </h5>
                            </div>
                            <div class="card-body">
                                <p class="card-text">{{ project.description }}</p>
                                <div class="mb-3">
                                    <small class="text-muted">ç«¯å£: {{ project.port }}</small>
                                </div>
                                <div class="mb-3">
                                    <h6>æ ¸å¿ƒåŠŸèƒ½:</h6>
                                    <div class="d-flex flex-wrap gap-1">
                                        {% for feature in project.features %}
                                        <span class="badge tech-badge">{{ feature }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div class="mt-auto">
                                    <div class="btn-group w-100">
                                        <button class="btn btn-success btn-sm" onclick="startProject('{{ project_id }}')">
                                            <i class="fas fa-play"></i> å¯åŠ¨
                                        </button>
                                        <button class="btn btn-primary btn-sm" onclick="viewProject('{{ project_id }}')">
                                            <i class="fas fa-eye"></i> æŸ¥çœ‹
                                        </button>
                                        <button class="btn btn-warning btn-sm" onclick="testProject('{{ project_id }}')">
                                            <i class="fas fa-flask"></i> æµ‹è¯•
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <!-- å¿«é€Ÿæ“ä½œé¢æ¿ -->
                <div class="row">
                    <div class="col-12">
                        <div class="card glass-card">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="mb-0">
                                    <i class="fas fa-bolt"></i> å¿«é€Ÿæ“ä½œé¢æ¿
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-md-3 mb-3">
                                        <button class="btn btn-success btn-lg w-100" onclick="startAllProjects()">
                                            <i class="fas fa-play-circle fa-2x mb-2"></i><br>
                                            å¯åŠ¨å…¨éƒ¨é¡¹ç›®
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <button class="btn btn-danger btn-lg w-100" onclick="stopAllProjects()">
                                            <i class="fas fa-stop-circle fa-2x mb-2"></i><br>
                                            åœæ­¢å…¨éƒ¨é¡¹ç›®
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <button class="btn btn-info btn-lg w-100" onclick="runAllTests()">
                                            <i class="fas fa-flask fa-2x mb-2"></i><br>
                                            è¿è¡Œå…¨éƒ¨æµ‹è¯•
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <button class="btn btn-secondary btn-lg w-100" onclick="cleanupSystem()">
                                            <i class="fas fa-broom fa-2x mb-2"></i><br>
                                            ç³»ç»Ÿæ¸…ç†
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å®è·µæŒ‡å—æ ‡ç­¾é¡µ -->
            <div class="tab-pane fade" id="guide">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="card glass-card mb-4">
                            <div class="card-header bg-info text-white">
                                <h4 class="mb-0">
                                    <i class="fas fa-book-open"></i> å¿«é€Ÿå¼€å§‹æŒ‡å—
                                </h4>
                            </div>
                            <div class="card-body">
                                <div class="accordion" id="guideAccordion">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#step1">
                                                <strong>1. ç¯å¢ƒå‡†å¤‡</strong>
                                            </button>
                                        </h2>
                                        <div id="step1" class="accordion-collapse collapse show" data-bs-parent="#guideAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># æ¿€æ´»SEEDç¯å¢ƒ
cd /home/parallels/seed-email-system
source development.env
conda activate seed-emulator

# åŠ è½½Dockeråˆ«å
cd examples/.not_ready_examples
source docker_aliases.sh

# æŸ¥çœ‹å¸®åŠ©
seed-help</pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#step2">
                                                <strong>2. é¡¹ç›®å¯åŠ¨</strong>
                                            </button>
                                        </h2>
                                        <div id="step2" class="accordion-collapse collapse" data-bs-parent="#guideAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># 29åŸºç¡€ç‰ˆ - å¿«é€Ÿä½“éªŒ
seed-29

# 29-1çœŸå®ç‰ˆ - ç”Ÿäº§ç¯å¢ƒä»¿çœŸ
seed-29-1

# 30 AIç‰ˆ - æ™ºèƒ½é’“é±¼
seed-30

# 31é«˜çº§ç‰ˆ - APTæ”»å‡»æ¨¡æ‹Ÿ
seed-31</pre>
                                                <div class="alert alert-info">
                                                    <strong>ğŸ’¡ æç¤º:</strong> æ¯ä¸ªé¡¹ç›®éƒ½æœ‰ç‹¬ç«‹çš„ç«¯å£å’ŒåŠŸèƒ½ï¼Œå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªé¡¹ç›®è¿›è¡Œå¯¹æ¯”æµ‹è¯•ã€‚
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#step3">
                                                <strong>3. åŠŸèƒ½æµ‹è¯•</strong>
                                            </button>
                                        </h2>
                                        <div id="step3" class="accordion-collapse collapse" data-bs-parent="#guideAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># å‘é€æµ‹è¯•é‚®ä»¶
seed-mail-send

# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
seed-status

# è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
python3 comprehensive_test.py

# OpenAIé›†æˆæµ‹è¯•
python3 demo_openai_integration.py</pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#step4">
                                                <strong>4. è°ƒè¯•ä¸ç»´æŠ¤</strong>
                                            </button>
                                        </h2>
                                        <div id="step4" class="accordion-collapse collapse" data-bs-parent="#guideAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># æ£€æŸ¥ç«¯å£å ç”¨
seed-check-ports

# å¼ºåŠ›æ¸…ç†ç³»ç»Ÿ
seed-force-cleanup

# ç´§æ€¥åœæ­¢
seed-emergency-stop

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
dclogf</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card glass-card mb-4">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-check-circle"></i> æœ€ä½³å®è·µ
                                </h5>
                            </div>
                            <div class="card-body">
                                <ul class="list-unstyled">
                                    <li class="mb-3">
                                        <i class="fas fa-lightbulb text-warning me-2"></i>
                                        <strong>æ¸è¿›å¼å­¦ä¹ :</strong> ä»29åŸºç¡€ç‰ˆå¼€å§‹ï¼Œé€æ­¥æ·±å…¥
                                    </li>
                                    <li class="mb-3">
                                        <i class="fas fa-clock text-info me-2"></i>
                                        <strong>åˆç†è§„åˆ’:</strong> æ¯ä¸ªé¡¹ç›®å¯åŠ¨éœ€è¦2-5åˆ†é’Ÿ
                                    </li>
                                    <li class="mb-3">
                                        <i class="fas fa-memory text-primary me-2"></i>
                                        <strong>èµ„æºç®¡ç†:</strong> æ³¨æ„Dockerå®¹å™¨èµ„æºå ç”¨
                                    </li>
                                    <li class="mb-3">
                                        <i class="fas fa-shield-alt text-danger me-2"></i>
                                        <strong>å®‰å…¨ç¬¬ä¸€:</strong> ä»…ç”¨äºæ•™è‚²å’Œç ”ç©¶ç›®çš„
                                    </li>
                                    <li class="mb-3">
                                        <i class="fas fa-save text-secondary me-2"></i>
                                        <strong>å®šæœŸå¤‡ä»½:</strong> ä¿å­˜é‡è¦çš„é…ç½®å’Œæ•°æ®
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="card glass-card">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="mb-0">
                                    <i class="fas fa-exclamation-triangle"></i> æ³¨æ„äº‹é¡¹
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-danger">
                                    <strong>âš ï¸ é‡è¦æé†’:</strong>
                                </div>
                                <ul class="text-muted small">
                                    <li>31é¡¹ç›®åŒ…å«é«˜çº§æ”»å‡»æŠ€æœ¯ï¼Œè°¨æ…ä½¿ç”¨</li>
                                    <li>OpenAI APIéœ€è¦æœ‰æ•ˆå¯†é’¥å’Œç½‘ç»œè®¿é—®</li>
                                    <li>Dockerå®¹å™¨å¯èƒ½æ¶ˆè€—å¤§é‡ç³»ç»Ÿèµ„æº</li>
                                    <li>å®šæœŸæ¸…ç†å®¹å™¨é¿å…ç£ç›˜ç©ºé—´ä¸è¶³</li>
                                    <li>æµ‹è¯•é‚®ä»¶è¯·ä½¿ç”¨å†…éƒ¨ç½‘ç»œç¯å¢ƒ</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æŠ€æœ¯æ€»ç»“æ ‡ç­¾é¡µ -->
            <div class="tab-pane fade" id="tech">
                <div class="row">
                    <div class="col-12">
                        <div class="card glass-card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h4 class="mb-0">
                                    <i class="fas fa-cogs"></i> æŠ€æœ¯æ¶æ„æ€»è§ˆ
                                </h4>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-6">
                                        <h5>æ ¸å¿ƒæŠ€æœ¯æ ˆ</h5>
                                        <div class="row">
                                            <div class="col-6">
                                                <h6>åŸºç¡€è®¾æ–½</h6>
                                                <ul class="list-unstyled">
                                                    <li><i class="fab fa-docker text-info"></i> Docker</li>
                                                    <li><i class="fas fa-network-wired text-primary"></i> SEED-Emulator</li>
                                                    <li><i class="fas fa-server text-secondary"></i> Flask</li>
                                                    <li><i class="fas fa-database text-warning"></i> PostgreSQL</li>
                                                </ul>
                                            </div>
                                            <div class="col-6">
                                                <h6>AIé›†æˆ</h6>
                                                <ul class="list-unstyled">
                                                    <li><i class="fas fa-brain text-success"></i> OpenAI GPT-4</li>
                                                    <li><i class="fas fa-robot text-info"></i> Ollama</li>
                                                    <li><i class="fas fa-fish text-warning"></i> Gophish</li>
                                                    <li><i class="fas fa-shield-alt text-danger"></i> AIæ£€æµ‹å¼•æ“</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <h5>é¡¹ç›®æ¼”è¿›è·¯çº¿</h5>
                                        <div class="timeline">
                                            <div class="timeline-item">
                                                <div class="timeline-marker bg-success"></div>
                                                <div class="timeline-content">
                                                    <h6>29åŸºç¡€ç‰ˆ</h6>
                                                    <p>Docker Mailserver + åŸºç¡€Webç•Œé¢</p>
                                                    <small class="text-muted">æ ¸å¿ƒåŠŸèƒ½å®ç°</small>
                                                </div>
                                            </div>
                                            <div class="timeline-item">
                                                <div class="timeline-marker bg-info"></div>
                                                <div class="timeline-content">
                                                    <h6>29-1çœŸå®ç‰ˆ</h6>
                                                    <p>å¤šæä¾›å•†ä»¿çœŸ + é«˜çº§ç½‘ç»œæ‹“æ‰‘</p>
                                                    <small class="text-muted">ç”Ÿäº§ç¯å¢ƒæ¨¡æ‹Ÿ</small>
                                                </div>
                                            </div>
                                            <div class="timeline-item">
                                                <div class="timeline-marker bg-warning"></div>
                                                <div class="timeline-content">
                                                    <h6>30 AIç‰ˆ</h6>
                                                    <p>AIé’“é±¼ + è‡ªåŠ¨åŒ–æ”»å‡»</p>
                                                    <small class="text-muted">æ™ºèƒ½åŒ–å‡çº§</small>
                                                </div>
                                            </div>
                                            <div class="timeline-item">
                                                <div class="timeline-marker bg-danger"></div>
                                                <div class="timeline-content">
                                                    <h6>31é«˜çº§ç‰ˆ</h6>
                                                    <p>APTæ¨¡æ‹Ÿ + OpenAIé›†æˆ</p>
                                                    <small class="text-muted">ç»ˆææ”»å‡»å¹³å°</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æŠ€æœ¯ç»†èŠ‚ -->
                <div class="row">
                    <div class="col-lg-8">
                        <div class="card glass-card">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-code-branch"></i> å…³é”®æŠ€æœ¯å®ç°
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="accordion" id="techAccordion">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#tech1">
                                                SEED-Emulatorç½‘ç»œæ„å»º
                                            </button>
                                        </h2>
                                        <div id="tech1" class="accordion-collapse collapse show" data-bs-parent="#techAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># email_simple.py - åŸºç¡€ç½‘ç»œæ„å»º
from seedemu import *

emu = Emulator()
base = Base()
routing = Routing()
ebgp = Ebgp()

# åˆ›å»ºäº’è”ç½‘äº¤æ¢ç‚¹
ix100 = base.createInternetExchange(100)
ix101 = base.createInternetExchange(101)

# åˆ›å»ºASå’Œç½‘ç»œ
as150 = base.createAutonomousSystem(150)
as151 = base.createAutonomousSystem(151)

# é…ç½®BGPè·¯ç”±
ebgp.addPrivatePeering(100, 150, 151, abRelationship=Relationship.Unfiltered)
ebgp.addPrivatePeering(101, 150, 151, abRelationship=Relationship.Unfiltered)</pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#tech2">
                                                Dockerå®¹å™¨ç¼–æ’
                                            </button>
                                        </h2>
                                        <div id="tech2" class="accordion-collapse collapse" data-bs-parent="#techAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># docker-compose.yml é…ç½®
version: '3.8'
services:
  mailserver:
    image: mailserver/docker-mailserver:edge
    container_name: seed-mail-1
    hostname: mail.seed.edu
    ports:
      - "2525:25"    # SMTP
      - "1430:143"   # IMAP
      - "5870:587"   # SMTPæäº¤
      - "9930:993"   # IMAPS
    volumes:
      - ./mail-data:/var/mail
      - ./config:/tmp/docker-mailserver
    environment:
      - ENABLE_SPAMASSASSIN=1
      - ENABLE_CLAMAV=1</pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#tech3">
                                                OpenAIé›†æˆå®ç°
                                            </button>
                                        </h2>
                                        <div id="tech3" class="accordion-collapse collapse" data-bs-parent="#techAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># OpenAIå®¢æˆ·ç«¯åˆå§‹åŒ–
from openai import OpenAI

class AdvancedPhishingSystem:
    def __init__(self):
        load_dotenv()
        api_key = os.getenv('OPENAI_API_KEY')
        base_url = os.getenv('OPENAI_BASE_URL', 'https://api.openai.com/v1')

        self.openai_client = OpenAI(
            api_key=api_key,
            base_url=base_url
        )

    async def generate_phishing_content(self, target_profile, campaign_type):
        prompt = self._build_phishing_prompt(target_profile, campaign_type)

        if self.openai_client:
            content = await self.openai_generate(prompt, model_type="content")
            evasion_result = await self.apply_evasion_techniques(content, target_profile)
            return evasion_result</pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="accordion-item">
                                        <h2 class="accordion-header">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#tech4">
                                                å¨èƒæ£€æµ‹ç®—æ³•
                                            </button>
                                        </h2>
                                        <div id="tech4" class="accordion-collapse collapse" data-bs-parent="#techAccordion">
                                            <div class="accordion-body">
                                                <pre class="code-preview"># å¤šæ¨¡æ€å¨èƒæ£€æµ‹
async def detect_phishing_threat(self, content: str, metadata: Dict = None) -> Dict:
    prompt = f"""
åˆ†æä»¥ä¸‹å†…å®¹æ˜¯å¦ä¸ºé’“é±¼æ”»å‡»ï¼š
{content}

è¯·ä»ä»¥ä¸‹æ–¹é¢åˆ†æï¼š
1. é’“é±¼ç‰¹å¾è¯†åˆ«
2. é£é™©ç­‰çº§è¯„ä¼°
3. å¯ç–‘å…ƒç´ è¯†åˆ«
4. æ£€æµ‹ç½®ä¿¡åº¦
5. å»ºè®®çš„é˜²æŠ¤æªæ–½
"""

    if self.openai_client:
        analysis = await self.openai_generate(prompt, model_type="threat")
    else:
        analysis = self._basic_phishing_detection(content)

    return {
        "is_phishing": self._extract_phishing_decision(analysis),
        "confidence": self._extract_confidence_score(analysis),
        "risk_level": self._extract_risk_level(analysis),
        "indicators": self._extract_threat_indicators(analysis),
        "recommendations": self._extract_security_recommendations(analysis)
    }</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card glass-card mb-4">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-bar"></i> æ€§èƒ½æŒ‡æ ‡
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-6 mb-3">
                                        <div class="metric-card">
                                            <i class="fas fa-clock text-info fa-2x mb-2"></i>
                                            <h4 class="text-info">2-3ç§’</h4>
                                            <p class="card-text small">AIå“åº”æ—¶é—´</p>
                                        </div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <div class="metric-card">
                                            <i class="fas fa-brain text-success fa-2x mb-2"></i>
                                            <h4 class="text-success">95%+</h4>
                                            <p class="card-text small">å†…å®¹è´¨é‡</p>
                                        </div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <div class="metric-card">
                                            <i class="fas fa-shield-alt text-warning fa-2x mb-2"></i>
                                            <h4 class="text-warning">92%</h4>
                                            <p class="card-text small">æ£€æµ‹å‡†ç¡®ç‡</p>
                                        </div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <div class="metric-card">
                                            <i class="fas fa-server text-primary fa-2x mb-2"></i>
                                            <h4 class="text-primary">99.5%</h4>
                                            <p class="card-text small">ç³»ç»Ÿå¯ç”¨ç‡</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card glass-card">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="mb-0">
                                    <i class="fas fa-tools"></i> å¼€å‘å·¥å…·
                                </h5>
                            </div>
                            <div class="card-body">
                                <ul class="list-unstyled">
                                    <li class="mb-2">
                                        <i class="fab fa-python text-primary me-2"></i>
                                        <strong>Python 3.11</strong>
                                        <br><small>ä¸»è¦å¼€å‘è¯­è¨€</small>
                                    </li>
                                    <li class="mb-2">
                                        <i class="fab fa-docker text-info me-2"></i>
                                        <strong>Docker</strong>
                                        <br><small>å®¹å™¨åŒ–éƒ¨ç½²</small>
                                    </li>
                                    <li class="fas fa-network-wired text-success me-2"></li>
                                    <strong>SEED-Emulator</strong>
                                    <br><small>ç½‘ç»œä»¿çœŸæ¡†æ¶</small>
                                    <li class="mb-2">
                                        <i class="fas fa-brain text-warning me-2"></i>
                                        <strong>OpenAI API</strong>
                                        <br><small>AIèƒ½åŠ›é›†æˆ</small>
                                    </li>
                                    <li class="mb-2">
                                        <i class="fab fa-bootstrap text-purple me-2"></i>
                                        <strong>Bootstrap 5</strong>
                                        <br><small>å‰ç«¯UIæ¡†æ¶</small>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…¶ä»–æ ‡ç­¾é¡µå ä½ -->
            <div class="tab-pane fade" id="code">
                <div class="row">
                    <div class="col-12">
                        <div class="card glass-card">
                            <div class="card-body text-center py-5">
                                <i class="fas fa-code fa-4x text-muted mb-4"></i>
                                <h4 class="text-muted">ä»£ç ç»“æ„æµè§ˆå™¨</h4>
                                <p class="text-muted">é€‰æ‹©å·¦ä¾§é¡¹ç›®æŸ¥çœ‹è¯¦ç»†ä»£ç ç»“æ„</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="design">
                <div class="row">
                    <div class="col-12">
                        <div class="card glass-card">
                            <div class="card-body text-center py-5">
                                <i class="fas fa-brain fa-4x text-muted mb-4"></i>
                                <h4 class="text-muted">è®¾è®¡æ€è·¯ä¸æ¶æ„</h4>
                                <p class="text-muted">æŸ¥çœ‹é¡¹ç›®çš„è®¾è®¡ç†å¿µå’ŒæŠ€æœ¯æ¶æ„</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="issues">
                <div class="row">
                    <div class="col-12">
                        <div class="card glass-card">
                            <div class="card-body text-center py-5">
                                <i class="fas fa-exclamation-triangle fa-4x text-muted mb-4"></i>
                                <h4 class="text-muted">é—®é¢˜è¯Šæ–­ä¸æµ‹è¯•</h4>
                                <p class="text-muted">ç³»ç»Ÿé—®é¢˜æ’æŸ¥å’Œæµ‹è¯•ç»“æœ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é¡¹ç›®è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="modal fade modal-dark" id="projectModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header border-primary">
                    <h5 class="modal-title">
                        <i class="fas fa-info-circle text-primary"></i> é¡¹ç›®è¯¦ç»†ä¿¡æ¯
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="project-details">
                    <!-- åŠ¨æ€åŠ è½½é¡¹ç›®è¯¦æƒ… -->
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- è‡ªå®šä¹‰JavaScript -->
    <script>
        // å…¨å±€å˜é‡
        let currentStatus = {};
        let refreshInterval;

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadSystemStatus();
            startAutoRefresh();

            // æ ‡ç­¾é¡µåˆ‡æ¢äº‹ä»¶ç›‘å¬ï¼ˆä½¿ç”¨Bootstrapçš„æ ‡å‡†äº‹ä»¶ï¼‰
            document.querySelectorAll('[data-bs-toggle="tab"]').forEach(tab => {
                tab.addEventListener('shown.bs.tab', function (e) {
                    const target = e.target.getAttribute('data-bs-target').substring(1);
                    loadTabContent(target);
                    console.log(`Switched to tab: ${target}`);
                });
            });
        });

        // åŠ è½½ç³»ç»ŸçŠ¶æ€
        function loadSystemStatus() {
            fetch('/api/system_status')
            .then(response => response.json())
            .then(data => {
                updateStatusDisplay(data);
                currentStatus = data;
            })
            .catch(error => {
                console.error('åŠ è½½çŠ¶æ€å¤±è´¥:', error);
                showToast('åŠ è½½ç³»ç»ŸçŠ¶æ€å¤±è´¥', 'error');
            });
        }

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatusDisplay(data) {
            const statusOverview = document.getElementById('status-overview');

            let html = '';

            // DockerçŠ¶æ€
            html += `
                <div class="col-md-3 mb-3">
                    <div class="card bg-secondary h-100">
                        <div class="card-body text-center">
                            <i class="fab fa-docker fa-2x ${data.docker.running ? 'text-success' : 'text-danger'} mb-2"></i>
                            <h6>DockerçŠ¶æ€</h6>
                            <p class="mb-1">${data.docker.running ? 'è¿è¡Œä¸­' : 'æœªè¿è¡Œ'}</p>
                            <small class="text-muted">${data.docker.containers}ä¸ªå®¹å™¨</small>
                        </div>
                    </div>
                </div>
            `;

            // é¡¹ç›®çŠ¶æ€
            Object.entries(data.projects).forEach(([projectId, status]) => {
                const statusClass = status === 'online' ? 'text-success' : status === 'offline' ? 'text-danger' : 'text-warning';
                const statusText = status === 'online' ? 'åœ¨çº¿' : status === 'offline' ? 'ç¦»çº¿' : 'æœªçŸ¥';

                html += `
                    <div class="col-md-3 mb-3">
                        <div class="card bg-secondary h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-server fa-2x ${statusClass} mb-2"></i>
                                <h6>${projectId.toUpperCase()}</h6>
                                <p class="mb-1 ${statusClass}">${statusText}</p>
                                <small class="text-muted">ç«¯å£: ${window.PROJECTS_INFO ? window.PROJECTS_INFO[projectId].port : 'N/A'}</small>
                            </div>
                        </div>
                    </div>
                `;
            });

            statusOverview.innerHTML = html;
        }

        // å¯åŠ¨é¡¹ç›®
        function startProject(projectId) {
            event.stopPropagation();

            if (confirm(`ç¡®å®šè¦å¯åŠ¨é¡¹ç›® ${projectId} å—ï¼Ÿ`)) {
                showToast(`æ­£åœ¨å¯åŠ¨é¡¹ç›® ${projectId}...`, 'info');

                fetch(`/api/start_project/${projectId}`)
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        showToast('é¡¹ç›®å¯åŠ¨æˆåŠŸ', 'success');
                        setTimeout(() => loadSystemStatus(), 2000);
                    } else {
                        showToast('é¡¹ç›®å¯åŠ¨å¤±è´¥: ' + result.error, 'error');
                    }
                })
                .catch(error => {
                    showToast('å¯åŠ¨è¯·æ±‚å¤±è´¥', 'error');
                });
            }
        }

        // åœæ­¢æ‰€æœ‰é¡¹ç›®
        function stopAllProjects() {
            if (confirm('ç¡®å®šè¦åœæ­¢æ‰€æœ‰é¡¹ç›®å—ï¼Ÿ')) {
                showToast('æ­£åœ¨åœæ­¢æ‰€æœ‰é¡¹ç›®...', 'info');

                fetch('/api/stop_all')
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        showToast('é¡¹ç›®åœæ­¢æˆåŠŸ', 'success');
                        setTimeout(() => loadSystemStatus(), 2000);
                    } else {
                        showToast('é¡¹ç›®åœæ­¢å¤±è´¥', 'error');
                    }
                })
                .catch(error => {
                    showToast('åœæ­¢è¯·æ±‚å¤±è´¥', 'error');
                });
            }
        }

        // ç³»ç»Ÿæ¸…ç†
        function cleanupSystem() {
            if (confirm('ç¡®å®šè¦æ¸…ç†ç³»ç»Ÿå—ï¼Ÿè¿™å°†åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨ã€‚')) {
                showToast('æ­£åœ¨æ¸…ç†ç³»ç»Ÿ...', 'info');

                fetch('/api/cleanup')
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        showToast('ç³»ç»Ÿæ¸…ç†æˆåŠŸ', 'success');
                        setTimeout(() => loadSystemStatus(), 3000);
                    } else {
                        showToast('ç³»ç»Ÿæ¸…ç†å¤±è´¥', 'error');
                    }
                })
                .catch(error => {
                    showToast('æ¸…ç†è¯·æ±‚å¤±è´¥', 'error');
                });
            }
        }

        // æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…
        function showProjectDetails(projectId) {
            const modal = new bootstrap.Modal(document.getElementById('projectModal'));
            const detailsDiv = document.getElementById('project-details');

            detailsDiv.innerHTML = '<div class="text-center"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">åŠ è½½ä¸­...</span></div></div>';

            fetch(`/api/project_info/${projectId}`)
            .then(response => response.json())
            .then(data => {
                let html = `
                    <div class="row">
                        <div class="col-md-8">
                            <h4 class="text-primary">${data.info.name}</h4>
                            <p class="lead">${data.info.description}</p>

                            <div class="mb-4">
                                <h6>æŠ€æœ¯æ ˆ:</h6>
                                <div class="d-flex flex-wrap gap-2">
                                    ${data.info.tech_stack.map(tech => `<span class="badge bg-info">${tech}</span>`).join('')}
                                </div>
                            </div>

                            <div class="mb-4">
                                <h6>æ ¸å¿ƒåŠŸèƒ½:</h6>
                                <ul>
                                    ${data.info.features.map(feature => `<li>${feature}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center">
                                <div class="mb-3">
                                    <span class="badge bg-${data.info.status.includes('å®Œæˆ') ? 'success' : 'warning'} fs-6">${data.info.status}</span>
                                </div>
                                <div class="mb-3">
                                    <i class="fas fa-server fa-3x text-primary mb-3"></i>
                                    <h6>ç«¯å£: ${data.info.port}</h6>
                                </div>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <div class="row">
                        <div class="col-12">
                            <h5>é¡¹ç›®ç»“æ„</h5>
                            <div class="code-preview" style="max-height: 300px; overflow-y: auto;">
                                ${generateFileTree(data.structure)}
                            </div>
                        </div>
                    </div>
                `;

                detailsDiv.innerHTML = html;
                modal.show();
            })
            .catch(error => {
                detailsDiv.innerHTML = '<div class="alert alert-danger">åŠ è½½é¡¹ç›®è¯¦æƒ…å¤±è´¥</div>';
                console.error('åŠ è½½é¡¹ç›®è¯¦æƒ…å¤±è´¥:', error);
            });
        }

        // ç”Ÿæˆæ–‡ä»¶æ ‘
        function generateFileTree(structure) {
            let html = '';
            const grouped = {};

            structure.forEach(file => {
                const ext = file.extension || 'folder';
                if (!grouped[ext]) grouped[ext] = [];
                grouped[ext].push(file);
            });

            Object.keys(grouped).sort().forEach(ext => {
                if (ext === 'py') html += `<div class="text-info"><strong>ğŸ“„ Pythonæ–‡ä»¶:</strong></div>`;
                else if (ext === 'yml' || ext === 'yaml') html += `<div class="text-warning"><strong>âš™ï¸ é…ç½®æ–‡ä»¶:</strong></div>`;
                else if (ext === 'md') html += `<div class="text-primary"><strong>ğŸ“– æ–‡æ¡£æ–‡ä»¶:</strong></div>`;
                else html += `<div class="text-muted"><strong>ğŸ“ å…¶ä»–æ–‡ä»¶:</strong></div>`;

                grouped[ext].forEach(file => {
                    const size = file.size ? `${(file.size / 1024).toFixed(1)}KB` : '';
                    html += `  ${file.path} ${size ? `(${size})` : ''}<br>`;
                });
                html += '<br>';
            });

            return html || 'æš‚æ— æ–‡ä»¶ç»“æ„ä¿¡æ¯';
        }

        // è‡ªåŠ¨åˆ·æ–°
        function startAutoRefresh() {
            refreshInterval = setInterval(() => {
                loadSystemStatus();
            }, 10000); // æ¯10ç§’åˆ·æ–°ä¸€æ¬¡
        }

        // åœæ­¢è‡ªåŠ¨åˆ·æ–°
        function stopAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
        }

        // åˆ·æ–°çŠ¶æ€
        function refreshStatus() {
            showToast('æ­£åœ¨åˆ·æ–°çŠ¶æ€...', 'info');
            loadSystemStatus();
        }

        // æ˜¾ç¤ºToastæ¶ˆæ¯
        function showToast(message, type = 'info') {
            // åˆ›å»ºç®€å•çš„Toastå®ç°
            const toast = document.createElement('div');
            toast.className = `alert alert-${type} position-fixed`;
            toast.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            toast.innerHTML = `
                ${message}
                <button type="button" class="btn-close float-end" onclick="this.parentElement.remove()"></button>
            `;
            document.body.appendChild(toast);

            setTimeout(() => {
                if (toast.parentElement) {
                    toast.remove();
                }
            }, 3000);
        }

        // åŠ è½½æ ‡ç­¾é¡µå†…å®¹
        function loadTabContent(tabId) {
            console.log(`Loading tab content: ${tabId}`);

            // æ ¹æ®æ ‡ç­¾é¡µIDæ‰§è¡Œç›¸åº”çš„åˆå§‹åŒ–
            switch(tabId) {
                case 'overview':
                    // æ€»è§ˆé¡µé¢çš„åˆå§‹åŒ–
                    loadSystemStatus();
                    break;
                case 'guide':
                    // å®è·µæŒ‡å—é¡µé¢åˆå§‹åŒ–
                    console.log('Guide tab loaded');
                    break;
                case 'tech':
                    // æŠ€æœ¯æ€»ç»“é¡µé¢åˆå§‹åŒ–
                    console.log('Tech tab loaded');
                    break;
                case 'code':
                    // ä»£ç ç»“æ„é¡µé¢åˆå§‹åŒ–
                    console.log('Code tab loaded');
                    break;
                case 'design':
                    // è®¾è®¡æ€è·¯é¡µé¢åˆå§‹åŒ–
                    console.log('Design tab loaded');
                    break;
                case 'issues':
                    // é—®é¢˜&æµ‹è¯•é¡µé¢åˆå§‹åŒ–
                    console.log('Issues tab loaded');
                    break;
                default:
                    console.log(`Unknown tab: ${tabId}`);
            }

            // æ·»åŠ æ·¡å…¥åŠ¨ç”»
            const tabElement = document.getElementById(tabId);
            if (tabElement) {
                tabElement.style.opacity = '0';
                setTimeout(() => {
                    tabElement.style.transition = 'opacity 0.3s ease-in';
                    tabElement.style.opacity = '1';
                }, 50);
            }
        }

        // å…¶ä»–åŠŸèƒ½å‡½æ•°
        function viewProject(projectId) {
            showProjectDetails(projectId);
        }

        function testProject(projectId) {
            event.stopPropagation();
            showToast(`æ­£åœ¨æµ‹è¯•é¡¹ç›® ${projectId}...`, 'info');

            fetch(`/api/run_test/${projectId}`)
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    showToast('æµ‹è¯•å¯åŠ¨æˆåŠŸ', 'success');
                } else {
                    showToast('æµ‹è¯•å¯åŠ¨å¤±è´¥', 'error');
                }
            });
        }

        function startAllProjects() {
            if (confirm('ç¡®å®šè¦å¯åŠ¨æ‰€æœ‰é¡¹ç›®å—ï¼Ÿ')) {
                showToast('æ­£åœ¨å¯åŠ¨æ‰€æœ‰é¡¹ç›®...', 'info');
                // è¿™é‡Œå¯ä»¥å®ç°æ‰¹é‡å¯åŠ¨é€»è¾‘
            }
        }

        function runAllTests() {
            if (confirm('ç¡®å®šè¦è¿è¡Œæ‰€æœ‰é¡¹ç›®çš„æµ‹è¯•å—ï¼Ÿ')) {
                showToast('æ­£åœ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•...', 'info');
                // è¿™é‡Œå¯ä»¥å®ç°æ‰¹é‡æµ‹è¯•é€»è¾‘
            }
        }

        // åˆå§‹åŒ–é¡¹ç›®ä¿¡æ¯
        window.PROJECTS_INFO = {{ projects|tojson }};
    </script>
</body>
</html>
