# 🎯 Gophish 钓鱼仿真系统使用说明

## 🚀 系统已完成搭建！

恭喜！您的钓鱼后仿真系统已经完全搭建完成。本系统包含以下组件：

### ✅ 已完成的组件

1. **Gophish 钓鱼平台** - 已启动运行在端口 3333
2. **XSS 漏洞服务器** - 模拟企业反馈系统 (端口 5001)
3. **SQL 注入服务器** - 模拟员工查询系统 (端口 5002)  
4. **Heartbleed 仿真服务器** - 模拟 SSL/TLS 服务 (端口 5003)
5. **损失评估仪表板** - 可视化攻击损失 (端口 5000)

## 🔧 第一步：启动所有服务

### 方式1：手动启动单个服务（推荐测试）
```bash
# 启动损失评估仪表板
cd dashboard
python3 dashboard.py &

# 启动XSS漏洞服务器  
cd ../vulnerable_servers/web_xss
python3 xss_server.py &

# 启动SQL注入服务器
cd ../db_sqli
python3 sqli_server.py &

# 启动Heartbleed仿真服务器
cd ../heartbleed_sim  
python3 heartbleed_server.py &
```

### 方式2：使用启动脚本
```bash
chmod +x start_simulation.sh
./start_simulation.sh
```

## 📧 第二步：配置 Gophish 邮箱

### 1. 访问管理界面
- 打开浏览器访问：https://localhost:3333
- 用户名：admin
- 密码：查看终端输出的随机密码

### 2. 配置QQ邮箱发送
进入 "Sending Profiles" → "New Profile"：

```
Name: QQ邮箱测试
From: 809050685@qq.com
Host: smtp.qq.com:465
Username: 809050685@qq.com  
Password: xutqpejdkpfcbbhi
```

**重要设置：**
- ✅ 勾选 "Ignore Certificate Errors"
- ✅ 使用端口 465 (SSL)

### 3. 创建邮件模板
进入 "Email Templates" → "New Template"：

```
Subject: 【紧急】系统安全升级通知

尊敬的用户，

我们的系统将进行重要安全升级，请立即点击以下链接完成必要的验证：
{{.URL}}

如不及时处理，您的账户可能被暂时冻结。

IT部门
```

### 4. 创建钓鱼页面
进入 "Landing Pages" → "New Page"：

```html
<!DOCTYPE html>
<html>
<head>
    <title>企业安全验证系统</title>
    <style>
        body { font-family: Arial; margin: 40px; background: #f5f5f5; }
        .login-box { max-width: 400px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { color: #2c3e50; text-align: center; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .warning { color: #e74c3c; font-size: 14px; text-align: center; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="login-box">
        <h2>🔐 系统安全验证</h2>
        <div class="warning">检测到异常登录，请验证身份</div>
        <form method="POST">
            <input type="email" name="email" placeholder="邮箱地址" required>
            <input type="password" name="password" placeholder="密码" required>
            <button type="submit">立即验证</button>
        </form>
        <script>
            // 收集浏览器信息
            document.addEventListener('DOMContentLoaded', function() {
                var info = {
                    browser: navigator.userAgent,
                    screen: screen.width + 'x' + screen.height,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
                };
                console.log('用户信息收集:', info);
            });
        </script>
    </div>
    {{.Tracker}}
</body>
</html>
```

## 🎯 第三步：创建钓鱼活动

### 1. 添加目标用户
进入 "Users & Groups" → "New Group"：
- 添加您的测试邮箱地址

### 2. 启动钓鱼活动
进入 "Campaigns" → "New Campaign"：
- **Name**: 测试钓鱼活动
- **Email Template**: 选择之前创建的模板
- **Landing Page**: 选择钓鱼页面
- **Sending Profile**: 选择QQ邮箱配置
- **Groups**: 选择目标用户组
- **Launch Date**: 立即发送

## 🛡️ 第四步：测试漏洞利用

### XSS 攻击测试 (端口 5001)
1. 访问：http://localhost:5001
2. 在反馈框中输入：
   ```html
   <script>alert('XSS攻击成功！窃取Cookie: ' + document.cookie)</script>
   ```
3. 查看攻击效果和数据泄露

### SQL 注入测试 (端口 5002)
1. 访问：http://localhost:5002
2. 在员工ID框中输入：
   ```sql
   1001' OR '1'='1
   ```
3. 查看所有员工数据泄露

### Heartbleed 测试 (端口 5003)
1. 访问：http://localhost:5003
2. 点击"执行Heartbleed测试"
3. 查看模拟的内存泄露数据

## 📊 第五步：查看损失评估

访问损失评估仪表板：http://localhost:5000
- 📈 实时攻击统计
- 💰 经济损失估算
- ⚠️ 风险等级评估
- 📋 详细攻击日志

### 损失评估模型
- **XSS攻击**: ¥50,000/次 (用户数据泄露)
- **SQL注入**: ¥200,000/次 (数据库暴露)
- **Heartbleed**: ¥300,000/次 (系统沦陷)

## 🔄 完整测试流程

### 阶段1：钓鱼邮件发送
1. ✅ 配置QQ邮箱SMTP
2. 📧 发送诱导性邮件
3. 📊 监控邮件打开率

### 阶段2：凭据收集
1. 👆 用户点击邮件链接
2. 🔑 用户输入登录凭据
3. 📝 Gophish记录凭据信息

### 阶段3：漏洞利用
1. 🌐 将用户重定向到漏洞服务器
2. ⚠️ 触发XSS/SQL注入/Heartbleed攻击
3. 💾 收集敏感数据

### 阶段4：损失评估
1. 📊 查看实时攻击统计
2. 💰 计算经济损失
3. 📈 生成风险报告

## 🌐 系统访问地址

| 服务 | 地址 | 用途 |
|------|------|------|
| Gophish管理 | https://localhost:3333 | 钓鱼邮件管理 |
| 损失评估 | http://localhost:5000 | 攻击统计分析 |
| XSS漏洞 | http://localhost:5001 | 企业反馈系统 |
| SQL注入 | http://localhost:5002 | 员工查询系统 |
| Heartbleed | http://localhost:5003 | SSL通信测试 |

## 📋 测试检查清单

### 邮件发送测试
- [ ] QQ邮箱SMTP配置正确
- [ ] 测试邮件发送成功
- [ ] 邮件内容显示正常
- [ ] 钓鱼链接可点击

### 钓鱼页面测试
- [ ] 页面外观逼真
- [ ] 表单提交正常
- [ ] 凭据收集成功
- [ ] 追踪脚本工作

### 漏洞服务器测试
- [ ] XSS攻击成功执行
- [ ] SQL注入获取数据
- [ ] Heartbleed模拟正常
- [ ] 攻击日志记录

### 损失评估测试
- [ ] 仪表板数据更新
- [ ] 损失计算准确
- [ ] 图表显示正常
- [ ] 风险等级正确

## ⚠️ 安全提醒

### 合法使用原则
- **仅用于安全研究和培训**
- **获得明确的书面授权**
- **不攻击真实的生产系统**
- **保护测试数据安全**

### 测试环境要求
- 使用隔离的测试网络
- 仅针对自己拥有的系统
- 及时清理测试痕迹
- 遵守相关法律法规

## 🆘 常见问题解决

### 邮件发送失败
```bash
# 检查QQ邮箱设置
1. 确认授权码正确
2. 检查SMTP端口 (465)
3. 启用SSL/TLS
4. 检查防火墙设置
```

### 服务器无法访问
```bash
# 检查服务状态
ps aux | grep python3
lsof -i :5000

# 重新启动服务
cd dashboard
python3 dashboard.py
```

### 漏洞测试失败
```bash
# 检查依赖
pip3 install flask requests

# 查看错误日志
tail -f logs/attacks.log
```

## 📞 获取帮助

如果遇到问题：
1. 📖 查看 `GOPHISH_CONFIG.md` 详细配置
2. 📋 检查 `README.md` 完整说明  
3. 🔍 查看终端错误输出
4. 🧪 使用 `test_servers.py` 诊断

---

## 🎉 恭喜完成！

您现在拥有了一个功能完整的钓鱼后仿真系统！

**系统特点：**
- 🎣 完整的钓鱼邮件平台
- 🚨 多种漏洞利用模拟
- 📊 可视化损失评估
- 📋 详细的攻击日志
- 🛡️ 安全测试场景

**建议用途：**
- 🏢 企业安全意识培训
- 🔬 网络安全研究
- 🎓 安全技术学习
- 📊 风险评估演示

**祝您使用愉快！** 🚀
